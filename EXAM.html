<!DOCTYPE html>
<meta charset="utf-8">

<h1 style="text-align: center;">GROCERY STORE</h1>

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v6.js"></script>

<!-- Create a div where the buttons will be -->
<div id="sort_buttons" style="margin-top: 20px; text-align: center;">
  <button class="sort_button", style ="background-color: #ead1dc;" onclick="sortData('Anna')">Anna</button>
  <button class="sort_button", style="background-color: #c3d4f1;" onclick="sortData('Camille')">Camille</button>
  <button class="sort_button", style="background-color: #f9cb9c;" onclick="sortData('Isabella')">Isabella</button>
  <button class="sort_button", style="background-color: #d9ead3;" onclick="sortData('Jonathan')">Jonathan</button>
  <button class="sort_button", style="background-color: #fff2cc;" onclick="sortData('Nikoline')">Nikoline</button>
</div>

<style>
.sort_button {
  margin: 5px;
  padding: 10px 20px;
  border: none;
  border-radius: 20px;
  color: black;
  font-size: 16px;
  cursor: pointer;
}

div.tooltip {	
    position: absolute;			
    text-align: left;								
    padding: 10px;				 
    border: 1px solid #fff;		
    border-radius: 8px;			
    pointer-events: none;
    font-size: 16px;
    opacity: 0;	
    transition: opacity 0.2s;		
}


.category.rect{
  pointer-events: all;
}

</style>

<div id="segment"></div>
<!-- Create a div where the graph will take place -->
<div id="my_dataviz"></div>



<script>

// ------------------------------ //
//                                //
//          CATEGORIES            //
//                                //
// ------------------------------ //

var categoriesData = [
    { category: "Fruits", x: 350, y: 100, width: 240, height: 150, color:"#d9ead3", text: "", tooltipText:  "We have bought vegetables for total 644,15 DKK."},
    { category: "Vegetables", x: 350, y: 250, width: 150, height: 400, color: "#d9ead3", text: "Vegetables", tooltipText: "We have bought vegetables for total 644,15 DKK."},
    { category: "Dairy", x: 620, y: 100, width: 240, height: 150, color: "#8ecae6", text: "Dairy", tooltipText: "We have bought dairy products for total 1.182,15 DKK."},
    { category: "Refrigerator", x: 890, y: 100, width: 240, height: 150, color: "#219ebc", text: "Regrigerator", tooltipText: "We have bought refrigerator products for total 374,15 DKK." },
    { category: "Colonialgoods", x: 1160, y: 100, width: 390, height: 150, color: "#ef476f", text: "Colonial", tooltipText: "We have bought colonial products for total 755,85 DKK." },
    { category: "Colonial", x: 1400, y: 245, width: 150, height: 150, color: "#ef476f", tooltipText:"We have bought colonial products for total 755,85 DKK." },
    { category: "Meat", x: 580, y: 350, width: 150, height: 300, color: "#f08080", text: "Meat", tooltipText:"We have bought meat for total 611,60 DKK." },
    { category: "Bread", x: 760, y: 350, width: 150, height: 300, color: " #eb5e28", text: "Bread", tooltipText:"We have bought bread for total 134,25 DKK." },
    { category: "Frost", x: 940, y: 350, width: 150, height: 300, color: "#0096c7", text: "Frost", tooltipText:"We have bought frost products for total 506,65 DKK."},
    { category: "Other", x: 1120, y: 350, width: 150, height: 300, color: "#d6ce93", text: "Other", tooltipText:"Other things we have bought for total 293,05 DKK."},
    { category: "Soda", x: 1335, y: 430, width: 215, height: 100, color: "#f9844a", text: "Alcohol/Soda", tooltipText: "We have bought alcohol/soda for total 411,00 DKK."},
    { category: "Candy", x: 1335 , y: 550, width: 215, height: 100, color: "#f3722c", text: "Candy/Snacks", tooltipText:"We have bought candy/snacks for total 510,25 DKK."},
    { category: "Checkout1", x: 700, y: 730, width: 100, height: 130, color: "#e09f3e", text: "Checkout", tooltipText: "In total we have used 5423,1 DKK."},
    { category: "Checkout2", x: 1060 , y: 730, width: 100, height: 130, color: "#e09f3e", text: "Discounts", tooltipText: "In total we have saved 676,64 DKK."},
    // Add more categories as needed
];

// ------------------------------ //
//                                //
//        SHOW RECTANGELS         //
//        AND TOOLTIP DIV         //
// ------------------------------ //

  // Append tooltip div
  var segment = d3.select("#segment");
  var tooltipDiv = segment.append("div")
    .attr("class", "tooltip")
    .style("opacity", 0);

// Add the path using this helper function
  var svgLines = segment.append("svg").attr("width", 1980).attr("height", 1000)
  svgLines.selectAll(".category-rect")
    .data(categoriesData)
    .enter()
    .append("rect")
    .attr("class", "category-rect")
    .attr("data-category", function(d) { return d.category; }) // Add data-category attribute
    .attr("x", function(d) { return d.x; })
    .attr("y", function(d) { return d.y; })
    .attr("width", function(d) { return d.width; })
    .attr("height", function(d) { return d.height; })
    .attr("fill", function(d) { return d.color; })
    .attr("text", function(d) { return d.text; })  // Change to desired fill color or pattern
    
    // make the tooltip appear beside the category rectangle
    .on("mouseover", function(event, d) {
    console.log("Mouseover event: ", d); // Debugging line
    d3.select(this).transition()
      .duration(50)
      .attr("opacity", 0.85);

    tooltipDiv.transition()
      .duration(50)
      .style("opacity", 1);

    tooltipDiv.html("<strong>"  + d.tooltipText + "</strong><br>") // Display category text and tooltipText as tooltip content
      .style("background", d.color)
      .style("top", (event.pageY + 10) + "px") // Position the tooltip 10px below the mouse position
      .style("left", (event.pageX + 10) + "px"); // Position the tooltip 10px to the right of the mouse position
    })

    .on("mousemove", function(event, d) {
      tooltipDiv.style("top", (event.pageY + 10) + "px") // Move the tooltip with the mouse
        .style("left", (event.pageX + 10) + "px");
    })
    .on("mouseout", function(event, d) {
      d3.select(this).transition()
        .duration(50)
        .attr("opacity", 1);

      tooltipDiv.transition()
        .duration(50)
        .style("opacity", 0);
    });

// ------------------------------ //
//                                //
//        SHOW GROCERY TEXT       //
//                                //
// ------------------------------ //
  
  //Adding the outlines of the grocery store text
  svgLines.selectAll(".category-text")
    .data(categoriesData)
    .enter()
    .append("text")
    .attr("class", "category-text")
    .attr("x", function(d) { return d.x + d.width / 2; }) // Adjust the x-coordinate for center alignment
    .attr("y", function(d) { return d.y + d.height / 2; }) // Adjust the y-coordinate for center alignment
    .text(function(d) { return d.text; })
    .attr("font-size", "20px")
    .attr("fill", "black")
    .attr("text-anchor", "middle") // Center align the text horizontally
    .attr("dominant-baseline", "middle"); // Center align the text vertically
    //.attr("transform", function(d) { return "rotate(90 " + (d.x + d.width / 2) + "," + (d.y + d.height / 2) + ")"; }); // Rotate the text vertically


// ------------------------------ //
//                                //
//        LINES FOR STORE         //
//                                //
// ------------------------------ //


  //top line
  svgLines.append('line')
  .attr('x1', 300)
  .attr('y1', 70)
  .attr('x2', 1600)
  .attr('y2', 70)
  .attr('stroke', 'black')
  .attr('stroke-width', 3);

  //bottom line
  svgLines.append('line')
  .attr('x1', 450)
  .attr('y1', 900)
  .attr('x2', 1400)
  .attr('y2', 900)
  .attr('stroke', 'black')
  .attr('stroke-width', 3);

  //left line
  svgLines.append('line')
  .attr('x1', 300)
  .attr('y1', 70)
  .attr('x2', 300)
  .attr('y2', 650)
  .attr('stroke', 'black')
  .attr('stroke-width', 3);

  //right line
  svgLines.append('line')
  .attr('x1', 1600)
  .attr('y1', 70)
  .attr('x2', 1600)
  .attr('y2', 650)
  .attr('stroke', 'black')
  .attr('stroke-width', 3);

  //left diagonal line
  svgLines.append('line')
  .attr('x1', 300)
  .attr('y1', 650)
  .attr('x2', 450)
  .attr('y2', 900)
  .attr('stroke', 'black')
  .attr('stroke-width', 3);

  //right diagonal line
  svgLines.append('line')
  .attr('x1', 1600)
  .attr('y1', 650)
  .attr('x2', 1400)
  .attr('y2', 900)
  .attr('stroke', 'black')
  .attr('stroke-width', 3);


</script>
